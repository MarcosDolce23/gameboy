<!DOCTYPE html>
<html>

	<head>
		<title>Pollen Boy</title>
		<meta charset='UTF-8'>

		<link rel='stylesheet' href='css/index.css'>
		<link rel='shortcut icon' href='img/favicon.png' type='image/png'>
	</head>
	<body>

		<!-- Title -->
		<div class='titlewrap'>
			<p class='title'>Pollen Boy</p>
			<p class='description'>A Gameboy Emulator made in JavaScript</p>
		</div>

		<div class='gbgap'></div>

		<div class='outerwrap'>

			<!-- GameBoy div -->
			<div class='gbwrap'> 

				<div class='gbtop'>
					<div class='screenwrap'>
						<canvas id='nanacanvas' width='160' height='144'></canvas>
						<div class='center_flex_div'>
							<img src='img/gb_logo.png' class='gb_logo' draggable='false'>
						</div>
					</div>
				</div>

				<div class='gbgap'></div>

				<div class='gbbottom'>
					<!-- File input -->
					<input id='nanafin' type='file' accept='.gb, .gbc, .bin, .rom' class='hide'>
					<label for='nanafin' class='filebutton'>Choose ROM</label>

					<!--<label id='nanapause' class='filebutton'>Pause</label>
					<br>

					Step Button
					<label id='nanapause' class='filebutton'>Step</label> -->
				</div>

			</div>

			<!-- Scripts -->
			<script src='src/cpu.js'></script>
			<script src='src/ops.js'></script>
			<script src='src/mem.js'></script>
			<script src='src/ppu.js'></script>
			<script src='src/joypad.js'></script>

			<script src='src/main.js'></script>

			<script>
				//window.onload = function () {

					const nanaCanvas = document.getElementById ('nanacanvas');
					const nanaFin = document.getElementById ('nanafin');

					// Gameboy
					var gb;
					function SetupGB () {
						if (gb)
							return;

						gb = new Gameboy ();
						gb.AttachCanvas (nanaCanvas);
					}

					SetupGB (); // For debugging shh

					// File reading
					nanaFin.onchange = function (evt) {
						var file = evt.target.files [0];
						if (!file)
							return;

						SetupGB ();

						// Try removing the below to test no rom behavior !
						gb.ReadRomFile (file, () => {
							// And then
							gb.Reset ();
							gb.Start ();
						});
					};

				//};
			</script>

		</div>

		<!-- Footer -->
		<div class='gbgap'></div>

		<div class='footwrap'>
			<p class='foottitle'>nectarboy | 2020 - 2021</p> <!-- â€¢ a spare bullet point for u -->

			<!-- Credits -->
			<a href='https://github.com/nectarboy/gameboy' class='hidehref'><p class='footsrc'>Source</p></a>
			<!-- Font: https://www.fontspace.com/super-legend-boy-font-f34010 -->
		</div>

	</body>

</html>